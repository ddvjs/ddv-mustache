#!/usr/bin/env node
'use strict'
// 标题
process.title = 'ddvMustache'
const logger = require('../build/logger')

// 默认
var defaultCommand = 'dev'
var commands = [
  defaultCommand,
  'init',
  'build',
  'start',
  'generate'
]

var cmd = process.argv[2]
if (!cmd) {
  cmd = defaultCommand
}
if (commands.indexOf(cmd) < 0) {
  logger.error('This command is not supported')
  process.exit(1)
}
var DEBUG = process.env.NODE_ENV === 'development' || false
switch (cmd) {
  case 'init':
    break
  case 'build':
    // 非调试模式
    DEBUG = false
    break
  case 'start':
    // 非调试模式
    DEBUG = false
    break
  case 'generate':
    // 非调试模式
    DEBUG = false
    break
  // case 'dev':
  default:
    // 默认命令
    cmd = 'dev'
    // 调试模式
    DEBUG = true
    break
}
// 开始运行
switch (cmd) {
  case 'build':
    logger.log('开发中')
    break
  case 'start':
  case 'dev':
    // 修改环境变量
    process.env.NODE_ENV = DEBUG ? 'development' : 'production'
    // 调试模式
    require('../lib/ddv-server-mustache')
    break
}
